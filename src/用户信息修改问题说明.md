# 用户信息修改问题说明

## 邮箱无法更新问题

检查后发现，后端 `UserServiceImpl` 类中的 `updateUserInfo` 方法没有处理 email 字段的更新，导致邮箱修改无法保存到数据库。

需要修改的文件：`muying-mall/src/main/java/com/muyingmall/service/impl/UserServiceImpl.java`

问题代码位置（约152-173行）：

```java
@Override
@Transactional(rollbackFor = Exception.class)
public boolean updateUserInfo(User user) {
    // 不允许修改敏感信息
    User updateUser = getById(user.getUserId());
    if (updateUser == null) {
        throw new BusinessException("用户不存在");
    }

    // 只更新允许修改的字段
    updateUser.setNickname(user.getNickname());
    updateUser.setAvatar(user.getAvatar());
    updateUser.setGender(user.getGender());
    updateUser.setBirthday(user.getBirthday());
    updateUser.setPhone(user.getPhone());
    // 缺少 email 字段的更新

    return updateById(updateUser);
}
```

## 建议修改（添加 email 字段更新）：

```java
@Override
@Transactional(rollbackFor = Exception.class)
public boolean updateUserInfo(User user) {
    // 不允许修改敏感信息
    User updateUser = getById(user.getUserId());
    if (updateUser == null) {
        throw new BusinessException("用户不存在");
    }

    // 只更新允许修改的字段
    updateUser.setNickname(user.getNickname());
    updateUser.setAvatar(user.getAvatar());
    updateUser.setGender(user.getGender());
    updateUser.setBirthday(user.getBirthday());
    updateUser.setPhone(user.getPhone());
    updateUser.setEmail(user.getEmail());  // 添加这一行，处理 email 字段更新

    return updateById(updateUser);
}
```

## 修改后期望的结果

完成上述修改后，用户在前端修改邮箱信息时，应该能正确保存到数据库并在页面上显示。 